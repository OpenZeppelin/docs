---
title: Upgrades
description: Upgrades
---

This crate provides interfaces and utilities related to upgradeability.

## Interfaces

<Callout>
Starting from version `3.x.x`, the interfaces are no longer part of the `openzeppelin_upgrades` package. The references
</Callout>
documented here are contained in the `openzeppelin_interfaces` package version `v{current_openzeppelin_interfaces_version}`.

### `++IUpgradeable++` link:https://github.com/OpenZeppelin/cairo-contracts/blob/release-v3.0.0-alpha.0/packages/interfaces/src/upgrades.cairo[pass:[<svg class="icon"><use href="#github-icon"/></svg>],role=heading-link]

```rust
use openzeppelin_interfaces::upgrades::IUpgradeable;
```

Interface of an upgradeable contract.

**Functions**

* [`+upgrade(new_class_hash)+`](#`[.contract-item-name]#++upgrade++#++(new_class_hash:-classhash)++`-[.item-kind]#external#)

#### Functions

#### `[.contract-item-name]#++upgrade++#++(new_class_hash: ClassHash)++` [.item-kind]#external#

Upgrades the contract code by updating its [class hash](https://docs.starknet.io/architecture-and-concepts/smart-contracts/class-hash/).

<Callout>
This function is usually protected by an [Access Control](access.adoc) mechanism.
</Callout>

### `++IUpgradeAndCall++` link:https://github.com/OpenZeppelin/cairo-contracts/blob/release-v3.0.0-alpha.0/packages/interfaces/src/upgrades.cairo[pass:[<svg class="icon"><use href="#github-icon"/></svg>],role=heading-link]

```rust
use openzeppelin_interfaces::upgrades::IUpgradeAndCall;
```

Interface for an upgradeable contract that couples an upgrade with a function call in the upgraded context.

**Functions**

* [`+upgrade_and_call(new_class_hash, selector, calldata)+`](#`[.contract-item-name]#++upgrade_and_call++#++(new_class_hash:-classhash,-selector:-felt252,-calldata:-span<felt252>)-→-span<felt252>++`-[.item-kind]#external#)

#### Functions

#### `[.contract-item-name]#++upgrade_and_call++#++(new_class_hash: ClassHash, selector: felt252, calldata: Span<felt252>) → Span<felt252>++` [.item-kind]#external#

Upgrades the contract code by updating its [class hash](https://docs.starknet.io/architecture-and-concepts/smart-contracts/class-hash/) and calls `selector` with the upgraded context.

<Callout>
This function is usually protected by an [Access Control](access.adoc) mechanism.
</Callout>

## Core

### `++UpgradeableComponent++` link:https://github.com/OpenZeppelin/cairo-contracts/blob/release-v3.0.0-alpha.0/packages/upgrades/src/upgradeable.cairo[pass:[<svg class="icon"><use href="#github-icon"/></svg>],role=heading-link]

```rust
use openzeppelin_upgrades::upgradeable::UpgradeableComponent;
```

Upgradeable component.

**Internal Implementations**

* [`+upgrade(self, new_class_hash)+`](#`[.contract-item-name]#++upgrade++#++(ref-self:-contractstate,-new_class_hash:-classhash)++`-[.item-kind]#internal#)
* [`+upgrade_and_call(self, new_class_hash, selector, calldata)+`](#`[.contract-item-name]#++upgrade_and_call++#++(ref-self:-contractstate,-new_class_hash:-classhash,-selector:-felt252,-calldata:-span<felt252>)-→-span<felt252>++`-[.item-kind]#internal#)

**Events**

* [`+Upgraded(class_hash)+`](#`[.contract-item-name]#++upgraded++#++(class_hash:-classhash)++`-[.item-kind]#event#)

#### Internal Functions

#### `[.contract-item-name]#++upgrade++#++(ref self: ContractState, new_class_hash: ClassHash)++` [.item-kind]#internal#

Upgrades the contract by updating the contract [class hash](https://docs.starknet.io/architecture-and-concepts/smart-contracts/class-hash/).

Requirements:

* `new_class_hash` must be different from zero.

Emits an {Upgraded} event.

#### `[.contract-item-name]#++upgrade_and_call++#++(ref self: ContractState, new_class_hash: ClassHash, selector: felt252, calldata: Span<felt252>) → Span<felt252>++` [.item-kind]#internal#

Replaces the contract’s class hash with `new_class_hash` and then calls `selector`
from the upgraded context.
This function returns the unwrapped `call_contract_syscall` return value(s), if available, of the `selector` call.

Requirements:

* `new_class_hash` must be different from zero.

<Callout>
The function call comes from the upgraded contract itself and not the account.
</Callout>

<Callout>
A similar behavior to `upgrade_and_call` can also be achieved with a list of calls from an account since the [SNIP-6](https://github.com/starknet-io/SNIPs/blob/main/SNIPS/snip-6.md) account standard supports multicall.
</Callout>
An account can execute a list of calls with [upgrade](#`[.contract-item-name]#++upgrade++#++(new_class_hash:-classhash)++`-[.item-kind]#external#) being the first element in the list and the extra function call as the second.
With this approach, the calls will execute from the account’s context and can’t be front-ran.

Emits an {Upgraded} event.

#### Events

#### `[.contract-item-name]#++Upgraded++#++(class_hash: ClassHash)++` [.item-kind]#event#

Emitted when the [class hash](https://docs.starknet.io/architecture-and-concepts/smart-contracts/class-hash/) is upgraded.
