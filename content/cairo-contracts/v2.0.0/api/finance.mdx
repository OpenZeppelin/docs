---
title: Finance
description: Finance
---

This crate includes primitives for financial systems.

## Interfaces

<Callout>
Starting from version `3.x.x`, the interfaces are no longer part of the `openzeppelin_finance` package. The references
</Callout>
documented here are contained in the `openzeppelin_interfaces` package version `current_openzeppelin_interfaces_version`.

### `++IVesting++` link:https://github.com/OpenZeppelin/cairo-contracts/blob/release-v3.0.0-alpha.0/packages/interfaces/src/finance/vesting.cairo[pass:[<svg class="icon"><use href="#github-icon"/></svg>],role=heading-link]

```rust
use openzeppelin_interfaces::vesting::IVesting;
```

Common interface for contracts implementing the vesting functionality.

**Functions**

* [`+start()+`](#`[.contract-item-name]#++start++#++()-→-u64++`-[.item-kind]#external#)
* [`+cliff()+`](#`[.contract-item-name]#++cliff++#++()-→-u64++`-[.item-kind]#external#)
* [`+duration()+`](#`[.contract-item-name]#++duration++#++()-→-u64++`-[.item-kind]#external#)
* [`+end()+`](#`[.contract-item-name]#++end++#++()-→-u64++`-[.item-kind]#external#)
* [`+released(token)+`](#`[.contract-item-name]#++released++#++(token:-contractaddress)-→-u256++`-[.item-kind]#external#)
* [`+releasable(token)+`](#`[.contract-item-name]#++releasable++#++(token:-contractaddress)-→-u256++`-[.item-kind]#external#)
* [`+vested_amount(token, timestamp)+`](#`[.contract-item-name]#++vested_amount++#++(token:-contractaddress,-timestamp:-u64)-→-u256++`-[.item-kind]#external#)
* [`+release(token)+`](#`[.contract-item-name]#++release++#++(token:-contractaddress)-→-u256++`-[.item-kind]#external#)

**Events**

* [`+AmountReleased(token, amount)+`](#`[.contract-item-name]#++amountreleased++#++(token:-contractaddress,-amount:-u256)++`-[.item-kind]#event#)

#### Functions

#### `[.contract-item-name]#++start++#++() → u64++` [.item-kind]#external#

Returns the timestamp marking the beginning of the vesting period.

#### `[.contract-item-name]#++cliff++#++() → u64++` [.item-kind]#external#

Returns the timestamp marking the end of the cliff period.

#### `[.contract-item-name]#++duration++#++() → u64++` [.item-kind]#external#

Returns the total duration of the vesting period.

#### `[.contract-item-name]#++end++#++() → u64++` [.item-kind]#external#

Returns the timestamp marking the end of the vesting period.

#### `[.contract-item-name]#++released++#++(token: ContractAddress) → u256++` [.item-kind]#external#

Returns the already released amount for a given `token`.

#### `[.contract-item-name]#++releasable++#++(token: ContractAddress) → u256++` [.item-kind]#external#

Returns the amount of a given `token` that can be released at the time of the call.

#### `[.contract-item-name]#++vested_amount++#++(token: ContractAddress, timestamp: u64) → u256++` [.item-kind]#external#

Returns the total vested amount of a specified `token` at a given `timestamp`.

#### `[.contract-item-name]#++release++#++(token: ContractAddress) → u256++` [.item-kind]#external#

Releases the amount of a given `token` that has already vested and returns that amount.

May emit an AmountReleased event.

#### Events

#### `[.contract-item-name]#++AmountReleased++#++(token: ContractAddress, amount: u256)++` [.item-kind]#event#

Emitted when vested tokens are released to the beneficiary.

## Vesting

### `++VestingComponent++` link:https://github.com/OpenZeppelin/cairo-contracts/blob/release-v3.0.0-alpha.0/packages/finance/src/vesting/vesting.cairo[pass:[<svg class="icon"><use href="#github-icon"/></svg>],role=heading-link]

```rust
use openzeppelin_finance::vesting::VestingComponent;
```

Vesting component implementing the [`IVesting`](#`++ivesting++`-link:https://github.com/openzeppelin/cairo-contracts/blob/release-v3.0.0-alpha.0/packages/interfaces/src/finance/vesting.cairo[pass:[<svg-class="icon"><use-href="#github-icon"/></svg>],role=heading-link]) interface.

**Vesting Schedule Trait Implementations**

**functions**

* xref:#VestingComponent-calculate_vested_amount[`++calculate_vested_amount(self, token, total_allocation,
timestamp, start, duration, cliff)++`]

<a name="VestingComponent-Embeddable-Impls"></a>**Embeddable Implementations**

<a name="VestingComponent-Embeddable-Impls-VestingImpl"></a>**VestingImpl**

* [`+start(self)+`](#`[.contract-item-name]#++start++#++(self:-@contractstate)-→-u64++`-[.item-kind]#external#)
* [`+cliff(self)+`](#`[.contract-item-name]#++cliff++#++(self:-@contractstate)-→-u64++`-[.item-kind]#external#)
* [`+duration(self)+`](#`[.contract-item-name]#++duration++#++(self:-@contractstate)-→-u64++`-[.item-kind]#external#)
* [`+end(self)+`](#`[.contract-item-name]#++end++#++(self:-@contractstate)-→-u64++`-[.item-kind]#external#)
* [`+released(self, token)+`](#`[.contract-item-name]#++released++#++(self:-@contractstate,-token:-contractaddress)-→-u256++`-[.item-kind]#external#)
* [`+releasable(self, token)+`](#`[.contract-item-name]#++releasable++#++(self:-@contractstate,-token:-contractaddress)-→-u256++`-[.item-kind]#external#)
* [`+vested_amount(self, token, timestamp)+`](#`[.contract-item-name]#++vested_amount++#++(self:-@contractstate,-token:-contractaddress,-timestamp:-u64)-→-u256++`-[.item-kind]#external#)
* [`+release(self, token)+`](#`[.contract-item-name]#++release++#++(ref-self:-contractstate,-token:-contractaddress)-→-u256++`-[.item-kind]#external#)

**Internal implementations**

**InternalImpl**

* [`+initializer(self, start, duration, cliff_duration)+`](#`[.contract-item-name]#++initializer++#++(ref-self:-contractstate,-start:-u64,-duration:-u64,-cliff_duration:-u64)++`-[.item-kind]#internal#)
* [`+resolve_vested_amount(self, token, timestamp)+`](#`[.contract-item-name]#++resolve_vested_amount++#++(self:-@contractstate,-token:-contractaddress,-timestamp:-u64)-→-u256++`-[.item-kind]#internal#)

#### VestingSchedule trait

A trait that defines the logic for calculating the vested amount based on a given timestamp.

<Callout>
You can read more about the trait’s purpose and how to use it [here](finance.adoc#vesting_schedule).
</Callout>

#### `[.contract-item-name]#++calculate_vested_amount++#++(self: @ContractState, token: ContractAddress, total_allocation: u256, timestamp: u64, start: u64, duration: u64, cliff: u64) → u256++` [.item-kind]#internal#

Calculates and returns the vested amount at a given `timestamp` based on the core vesting parameters.

#### Functions

#### `[.contract-item-name]#++start++#++(self: @ContractState) → u64++` [.item-kind]#external#

Returns the timestamp marking the beginning of the vesting period.

#### `[.contract-item-name]#++cliff++#++(self: @ContractState) → u64++` [.item-kind]#external#

Returns the timestamp marking the end of the cliff period.

#### `[.contract-item-name]#++duration++#++(self: @ContractState) → u64++` [.item-kind]#external#

Returns the total duration of the vesting period.

#### `[.contract-item-name]#++end++#++(self: @ContractState) → u64++` [.item-kind]#external#

Returns the timestamp marking the end of the vesting period.

#### `[.contract-item-name]#++released++#++(self: @ContractState, token: ContractAddress) → u256++` [.item-kind]#external#

Returns the already released amount for a given `token`.

#### `[.contract-item-name]#++releasable++#++(self: @ContractState, token: ContractAddress) → u256++` [.item-kind]#external#

Returns the amount of a given `token` that can be released at the time of the call.

#### `[.contract-item-name]#++vested_amount++#++(self: @ContractState, token: ContractAddress, timestamp: u64) → u256++` [.item-kind]#external#

Returns the total vested amount of a specified `token` at a given `timestamp`.

#### `[.contract-item-name]#++release++#++(ref self: ContractState, token: ContractAddress) → u256++` [.item-kind]#external#

Releases the amount of a given `token` that has already vested and returns that amount.

<Callout>
If the releasable amount is zero, this function won’t emit the event
</Callout>
or attempt to transfer the tokens.

Requirements:

* `transfer` call to the `token` must return `true` indicating a successful transfer.

May emit an AmountReleased event.

#### Internal functions

#### `[.contract-item-name]#++initializer++#++(ref self: ContractState, start: u64, duration: u64, cliff_duration: u64)++` [.item-kind]#internal#

Initializes the component by setting the vesting `start`, `duration` and `cliff_duration`. To prevent
reinitialization, this should only be used inside of a contract’s constructor.

Requirements:

* `cliff_duration` must be less than or equal to `duration`.

#### `[.contract-item-name]#++resolve_vested_amount++#++(self: @ContractState, token: ContractAddress, timestamp: u64) → u256++` [.item-kind]#internal#

Returns the vested amount that’s calculated using the [VestingSchedule](api/finance.adoc#VestingComponent-Vesting-Schedule) trait implementation.

### `++LinearVestingSchedule++` link:https://github.com/OpenZeppelin/cairo-contracts/blob/release-v3.0.0-alpha.0/packages/finance/src/vesting/vesting.cairo[pass:[<svg class="icon"><use href="#github-icon"/></svg>],role=heading-link]

```rust
use openzeppelin_finance::vesting::LinearVestingSchedule;
```

Defines the logic for calculating the vested amount, incorporating a cliff period.
It returns 0 before the cliff ends. After the cliff period, the vested amount returned
is directly proportional to the time passed since the start of the vesting schedule.

## Presets

### `++VestingWallet++` link:https://github.com/OpenZeppelin/cairo-contracts/blob/release-v3.0.0-alpha.0/packages/presets/src/vesting.cairo[pass:[<svg class="icon"><use href="#github-icon"/></svg>],role=heading-link]

```rust
use openzeppelin::presets::VestingWallet;
```

A non-upgradable contract leveraging [VestingComponent](#`++vestingcomponent++`-link:https://github.com/openzeppelin/cairo-contracts/blob/release-v3.0.0-alpha.0/packages/finance/src/vesting/vesting.cairo[pass:[<svg-class="icon"><use-href="#github-icon"/></svg>],role=heading-link]) and [OwnableComponent](api/access.adoc#OwnableComponent).

<Callout>
The contract is intentionally designed to be non-upgradable to ensure that neither the vesting initiator
</Callout>
nor the vesting beneficiary can modify the vesting schedule without the consent of the other party.

**presets-page**

VestingWallet-class-hash

**Constructor**

* [`+constructor(self, beneficiary, start, duration, cliff_duration)+`](#`[.contract-item-name]#++constructor++#++(ref-self:-contractstate,-beneficiary:-contractaddress,-start:-u64,-duration:-u64,-cliff_duration:-u64)++`-[.item-kind]#constructor#)

**Embedded Implementations**

* [`+VestingImpl+`](#VestingComponent-Embeddable-Impls-VestingImpl)

* [`+OwnableMixinImpl+`](/api/access.adoc#OwnableComponent-Mixin-Impl)

#### Constructor

#### `[.contract-item-name]#++constructor++#++(ref self: ContractState, beneficiary: ContractAddress, start: u64, duration: u64, cliff_duration: u64)++` [.item-kind]#constructor#

Initializes the vesting component by setting the vesting `start`, `duration` and `cliff_duration`. Assigns `beneficiary` as the contract owner and the vesting beneficiary.

Requirements:

* `cliff_duration` must be less than or equal to `duration`.
